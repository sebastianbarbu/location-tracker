<!DOCTYPE html>
<html>
<head>
  <title>Track Me</title>
</head>
<body>
  <h1>üìç Location Access</h1>
  <p>Sending your location automatically...</p>

  <script>
    const userId = new URLSearchParams(window.location.search).get('u') || 'user0';

    function send(pos) {
      fetch('https://location-backend-gyli.onrender.com/locatie', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          userId,
          lat: pos.coords.latitude,
          lon: pos.coords.longitude
        })
      });
    }

    function startTracking() {
      if (!navigator.geolocation) {
        alert('Geolocation not supported!');
        return;
      }

      navigator.geolocation.watchPosition(send, err => {
        alert('Location permission is required!');
      }, {
        enableHighAccuracy: true,
        timeout: 10000,
        maximumAge: 0
      });
    }

    // Trigger tracking as soon as the page loads
    window.onload = startTracking;
  </script>
</body>
</html>
